  âœ… OPÃ‡ÃƒO RECOMENDADA: FORK + QUEUES

  - Suporte: âœ… SIM, milhares de instÃ¢ncias WhatsApp
  - Arquitetura: 1 processo principal + N workers
  - Performance: Superior para alta concorrÃªncia

  ğŸ—ï¸ ARQUITETURA PROPOSTA:

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                 PM2 FORK MODE                           â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ PROCESSO PRINCIPAL (server.js)                         â”‚
  â”‚ â€¢ Gerencia TODAS instÃ¢ncias WhatsApp (sem conflito)    â”‚
  â”‚ â€¢ Recebe mensagens â†’ Envia para QUEUES                 â”‚
  â”‚ â€¢ 1 processo = 1 conexÃ£o por nÃºmero (estÃ¡vel)          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                  REDIS/BULL QUEUES                     â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ MESSAGE_QUEUE    â”‚ WEBHOOK_QUEUE    â”‚ BROADCAST_QUEUE   â”‚
  â”‚ â€¢ Processar msgs â”‚ â€¢ Enviar webhooksâ”‚ â€¢ Envios em massa â”‚
  â”‚ â€¢ Rate limiting  â”‚ â€¢ Retry logic    â”‚ â€¢ Agendamentos    â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                 WORKERS SEPARADOS                       â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ WORKER 1         â”‚ WORKER 2         â”‚ WORKER N          â”‚
  â”‚ â€¢ Process msgs   â”‚ â€¢ Send webhooks  â”‚ â€¢ Handle uploads  â”‚
  â”‚ â€¢ 2-4 CPU cores  â”‚ â€¢ HTTP requests  â”‚ â€¢ File processing â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  âš¡ VANTAGENS PARA MILHARES DE INSTÃ‚NCIAS:

  1. ğŸ“± WhatsApp Stability
    - âœ… 1 processo = sem conflitos Baileys
    - âœ… 1 conexÃ£o por nÃºmero = estÃ¡vel
    - âœ… ReconexÃ£o individual (nÃ£o afeta outras)
  2. ğŸš€ Performance EscalÃ¡vel
    - âœ… Queues processam 50K+ msgs/minuto
    - âœ… Workers independentes (crash-isolated)
    - âœ… Rate limiting automÃ¡tico
    - âœ… Batch processing inteligente
  3. ğŸ’¾ Uso Eficiente de Recursos
    - âœ… RAM: ~200MB processo principal + 50MB/worker
    - âœ… CPU: DistribuÃ­do entre workers
    - âœ… I/O: Non-blocking via queues